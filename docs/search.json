[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "روش‌های عددی و شبیه‌سازی",
    "section": "",
    "text": "فصل اول: تولید اعداد تصادفی",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>فصل اول: تولید اعداد تصادفی</span>"
    ]
  },
  {
    "objectID": "index.html#احتمال",
    "href": "index.html#احتمال",
    "title": "روش‌های عددی و شبیه‌سازی",
    "section": "احتمال",
    "text": "احتمال\nمثال 1: احتمال اینکه .\n\nحل: برای حل",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>فصل اول: تولید اعداد تصادفی</span>"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "فصل دوم: تولید داده از توزیع‌های آماری",
    "section": "",
    "text": "شبیه سازی یک ابزار قدرتمند برای طراحی و تحلیل سیستم‌ها یا فرآیندهای پیچیده است که با ارائه حالت یا نمونه‌های مشابه با نمونه اصلی، به استفاده کنندگان از آن، امکان انجام آزمایش با سیستم‌هایی را می‌دهد که در عمل غیر ممکن یا پر هزینه هستند.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>فصل دوم: تولید داده از توزیع‌های آماری</span>"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "خلاصه",
    "section": "",
    "text": "این خلاصه‌ای از کتاب است.\n\n1 + 1\n\n[1] 2",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>خلاصه</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "منابع",
    "section": "",
    "text": "Knuth, Donald E. 1984. “Literate Programming.” Comput.\nJ. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "منابع"
    ]
  },
  {
    "objectID": "index.html#مقدمه",
    "href": "index.html#مقدمه",
    "title": "روش‌های عددی و شبیه‌سازی",
    "section": "مقدمه",
    "text": "مقدمه\nشبیه سازی یک ابزار قدرتمند برای طراحی و تحلیل سیستم‌ها یا فرآیندهای پیچیده است که با ارائه حالت یا نمونه‌های مشابه با نمونه اصلی، به استفاده کنندگان از آن، امکان انجام آزمایش با سیستم‌هایی را می‌دهد که در عمل غیر ممکن یا پر هزینه هستند.\nمثال:\n\nآموزش خلبانی\nمانور زلزله\nسینما چندبُعدی",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>فصل اول: تولید اعداد تصادفی</span>"
    ]
  },
  {
    "objectID": "index.html#شبیهسازی-در-آمار",
    "href": "index.html#شبیهسازی-در-آمار",
    "title": "روش‌های عددی و شبیه‌سازی",
    "section": "شبیه‌سازی در آمار",
    "text": "شبیه‌سازی در آمار\nاز کاربردهای شبیه‌سازی در آمار می‌توان موارد زیر را نام برد:\n\nتولید اعداد تصادفی و شبه‌تصادفی\nتولید داده‌های تصادفی از توزیع‌های گسسته یا پیوسته\nمحاسبه (تقریب) انتگرال‌ها و احتمال‌های پیچیده\nتقریب امید ریاضی توابعی از متغیرهای تصادفی\nتقریب توان یک آزمون\n\n\nاعداد تصادفی و شبه‌تصادفی\nاعداد تصادفی (Random Numbers): اعدادی هستند که بر مبنای یک سری جریانات یا بر اساس یک منبع خارجی بدون هیچ رابطه خاصی تولید می‌شوند، بنابراین این اعداد قابلیت باز تولید را ندارند، یعنی اگر مجموعه‌ای از اعداد از اعداد تصادفی تولید شوند دوباره نمی‌توان دقیقاً همان اعداد را تولید کرد.\nاعداد شبه‌تصادفی (PseudoRandom Numbers): اعدادی هستند که بر مبنای یک رابطه ریاضی به دست می‌آیند. بنابراین قابلیت بازتولید دارند، یعنی اگر مجموعه‌ای از اعداد از اعداد تصادفی تولید شوند دوباره می‌توان دقیقاً همان اعداد را تولید کرد.\n\n\nروش‌های سنتی تولید اعداد تصادفی\nدر گذشته برای شبیه‌سازی اعداد تصادفی در بازه (0,1) از عقربه‌ گردان استفاده می‌شد. این وسیله دارای صفحه‌ی دایره‌ مانندی شبیه ساعت است که محیط آن در فاصله صفر تا یک درجه‌بندی شده است. در مرکز این دایره یک عقربه قرار می‌گیرد که می‌تواند آن را چرخاند و در نتیجه عقربه بعد از دهها بار چرخش (که تعداد دفعات چرخش آن نیز تقریبا تصادفی است) از حرکت می‌ایستد. نوک عقربه عدد تصادفی مورد نظر را مشخص می‌کند.\n\n\n\n\n\n\n\nروش‌های ابداعی\n\nپرتاب یک سکه\nباز کردن صفحه‌ای از یک کتاب به صورت تصادفی\nانتخاب از بین چند گوی\n\n\nتمرین 1:\nالف) روشی تصادفی برای تولید عدد از بازه (0,100) پیشنهاد دهید.\nب) آیا می توان روش ابداعی شما را برای تولید داده از هر بازه‌ای مورد استفاد قرار داد؟ مثال بزنید.\nج) آیا می توان از روش ابداعی شما برای تولید داده از نوع کیفی (میزان تحصیلات یا گروه خونی) نیز استفاده کرد؟",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>فصل اول: تولید اعداد تصادفی</span>"
    ]
  },
  {
    "objectID": "index.html#روش-توان-دوم-ارقام-میانی",
    "href": "index.html#روش-توان-دوم-ارقام-میانی",
    "title": "روش‌های عددی و شبیه‌سازی",
    "section": "روش توان دوم ارقام میانی",
    "text": "روش توان دوم ارقام میانی\nاین روش یک روش ریاضی برای تولید اعداد تصادفی \\(m\\) رقمی است. در این روش که به وسیله فون نیومن و متروپولیس (1946) پیشنهاد شده، مراحل زیر را انجام می‌دهیم:\n\nبه دلخواه عددی \\(m\\) رقمی را در نظر می‌گیریم\nاین عدد را به توان دو می‌رسانیم و در صورت لزوم عدد صفر را به سمت چپ عدد بدست آمده اضافه می‌کنیم.\n\\(m\\) رقم میانی عدد حاصل شده را به عنوان عدد تصادفی تولید شده در نظر می‌گیریم.\nبرای تولید دنباله‌ای از اعداد تصادفی گام‌های 2 و 3 را تکرار می‌کنیم.\n\nنکته: برای تولید اعداد تصادفی در بازه \\((0,1)\\) با استفاده از روش توان دوم ارقام میانی کافی است در پایان کار، دنباله اعداد \\(m\\) رقمی بدست آمده را بر \\(10^m\\) تقسیم کرد.\n\nمثال:\nالف) با استفاده از روش توان دوم ارقام میانی یک عدد 4 رقمی تولید کنید.\nب) با استفاده از نکته فوق عددی تصادفی در بازه \\((0,1)\\) تولید کنید.\\[\nx_0 = 2152 \\quad \\longrightarrow\\quad x_0^2 = 04631104 \\quad\\longrightarrow \\quad x_1 = 6311\n\\]\nبرای تولید اعداد دیگر کافیست که عدد 6311 را به عنوان مقدار اولیه الگوریتم در نظر بگیریم.\n\nمثال:\nمثال قبل را با استفاده از نرم افزار R حل کنید.\n\nx0 &lt;- 2152\nx1 &lt;- x0^2\nif(nchar(x1)%%2==1){t &lt;- substr(x1,2,5)}else{t &lt;- substr(x1,3,6)}\nas.numeric(t)\n\n[1] 6311\n\n\n\nتمرین 2:\nبه وسیله نرم افزار R تابعی را بنویسید که براساس روش توان دوم ارقام میانی n عدد تصادفی چهار رقمی تولید کند.\n\n\nمعایب روش توان دوم ارقام میانی\n\nرخ دادن دوره تناوب\nفرض کنید مقدار اولیه 2500 باشد، در نتیجه توان دوم این عدد 6250000 خواهد بود و در نهایت همان 2500 انتخاب خواهد شد.\nخروجی نامعتبر\nفرض کنید مقدار اولیه 1000 باشد، در نتیجه توان دوم این عدد 1000000 خواهد بود و در نهایت عدد 0000 انتخاب خواهد شد.\nفرض کنید مقدار اولیه 1001 باشد، در نتیجه توان دوم این عدد 1002001 خواهد بود و در نهایت عدد 0020 انتخاب خواهد شد.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>فصل اول: تولید اعداد تصادفی</span>"
    ]
  },
  {
    "objectID": "index.html#روشهای-همنهشتی",
    "href": "index.html#روشهای-همنهشتی",
    "title": "روش‌های عددی و شبیه‌سازی",
    "section": "روش‌های همنهشتی",
    "text": "روش‌های همنهشتی\nروش‌های همنهشتی برای تولید اعداد تصادفی شامل سه روش همنهشتی ضربی، همنهشتی مرکب و همنهشتی جمعی می باشد.\n\nروش‌ همنهشتی ضربی\nدر این روش الگوریتم تولید عدد با یک مقدار اولیه (initial value) مانند \\(x_0\\) شروع می‌شود که عدد تغذیه (seed) نامیده می‌شود. سپس مقادیر \\(x_n (n \\geq 1)\\) را از رابطه بازگشتی \\(x_n \\overset{m}{\\equiv} ax_{n-1}\\) محاسبه می‌کنیم که در آن \\(a\\) و \\(m\\) (پیمانه modulo) اعداد صحیح مثبت هستند. رابطه فوق بدین معنی است که باقیمانده تقسیم \\(ax_{n-1}\\) بر \\(m\\) به عنوان مقدار \\(x_n\\) می‌تواند یکی از مقادیر صحیح صفر تا \\(m-1\\) را اختیار کند، لذا \\(\\frac{x_n}{m}\\) یک عدد شبه تصادفی در بازه \\((0,1)\\) است.\n\nمثال:\nبا انتخاب مقادیر دلخواه \\(x_0, a, m\\) دو عدد تصادفی در بازه \\((0,1)\\) تولید کنید.\n\\[\n\\begin{align}\n& x_0 = 51, \\quad a = 13, \\quad m =7\\\\\n& x_1 \\overset{7}{\\equiv} 13 \\times 51 = 663 \\Rightarrow x_1 = 5 \\Rightarrow \\frac{5}{7} = 0.7142857\\\\\n& x_2 \\overset{7}{\\equiv} 13 \\times 5 = 65 \\Rightarrow x_2 = 2 \\Rightarrow \\frac{2}{7} = 0.2857143\n\\end{align}\n\\]\nمثال:\nمثال بالا را با استفاده از نرم افزار R حل کنید.\n\nx0 &lt;- 51 ; a &lt;- 13 ; m &lt;- 7\nx1 &lt;- (a*x0) %% m \nx2 &lt;- (a*x1) %% m \nx1/m ; x2/m\n\n[1] 0.7142857\n\n\n[1] 0.2857143\n\n\n\nتمرین 3:\nبه وسیله نرم افزار R برنامه‌ای بنویسید که n عدد تصادفی از بازه (0,1) بر اساس روش همنهشتی ضربی تولید کند.\n\n\n\nروش‌ همنهشتی جمعی\nدر این روش دنباله اعداد تصادفی از رابطه \\(x_n \\overset{m}{\\equiv} x_{n-1} + x_{n-2}\\) بدست می‌آیند. در روش فوق باید دو مقدار اولیه \\(x_0\\) و \\(x_1\\) از قبل مشخص شوند.\n\\[\n\\begin{align}\n& x_0 = 12, \\quad x_1 = 3, \\quad m =7\\\\\n& x_2 \\overset{7}{\\equiv} 12 + 3 \\Rightarrow x_2 = 1 \\\\\n& \\frac{x_2}{7} = \\frac{1}{7} = 0.1428571\n\\end{align}\n\\]\n\nتمرین 4:\nبه وسیله نرم افزار R برنامه‌ای بنویسید که n عدد تصادفی از بازه (0,1) بر اساس روش همنهشتی جمعی تولید کند.\n\n\n\nروش‌ همنهشتی مرکب\nدر روش همنهشتی مرکب که ترکیبی از حالات ضربی و جمعی است، دنباله اعداد تصادفی از رابطه همنهشتی \\(x_n \\overset{m}{\\equiv} ax_{n-1} + x_{n-2}\\) بدست می‌آیند.\nنکته:\nدر روش‌های همنهشتی چون هر یک از اعداد \\(x_n\\) یکی از مقادیر صحیح صفر تا \\(m-1\\) را اختیار می‌کند، لذا بعد از اینکه تعداد متناهی (حداکثر \\(m\\) ) مقدار تولید شود، یک مقدار بایستی تکرار شود و به مجرد پیش آمدن این امر تکرار تمام دنباله‌ها شروع می‌شود؛ لذا باید مؤلفه‌های \\(a\\) و \\(m\\) را طوری انتخاب کنیم که از رخ دادن چنین امری جلوگیری شود.\n\nتمرین 5:\nبه وسیله نرم افزار R برنامه‌ای بنویسید که n عدد تصادفی از بازه (0,1) بر اساس روش همنهشتی مرکب تولید کند.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>فصل اول: تولید اعداد تصادفی</span>"
    ]
  },
  {
    "objectID": "Ch_01.html",
    "href": "Ch_01.html",
    "title": "فصل دوم: تولید داده از توزیع‌های آماری",
    "section": "",
    "text": "شبیه سازی یک ابزار قدرتمند برای طراحی و تحلیل سیستم‌ها یا فرآیندهای پیچیده است که با ارائه حالت یا نمونه‌های مشابه با نمونه اصلی، به استفاده کنندگان از آن، امکان انجام آزمایش با سیستم‌هایی را می‌دهد که در عمل غیر ممکن یا پر هزینه هستند.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>فصل دوم: تولید داده از توزیع‌های آماری</span>"
    ]
  },
  {
    "objectID": "Ch_2.html",
    "href": "Ch_2.html",
    "title": "فصل دوم: شبیه‌سازی از توزیع‌های آماری",
    "section": "",
    "text": "شبیه‌سازی از توزیع‌های گسسته\nشبیه‌سازی از توزیع‌های گسسته به سه روش انجام می‌گیرد:",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>فصل دوم: شبیه‌سازی از توزیع‌های آماری</span>"
    ]
  },
  {
    "objectID": "Ch_2.html#شبیهسازی-از-توزیعهای-گسسته",
    "href": "Ch_2.html#شبیهسازی-از-توزیعهای-گسسته",
    "title": "فصل دوم: شبیه‌سازی از توزیع‌های آماری",
    "section": "",
    "text": "روش وارون\nروش رد-پذیرش\nروش مرکب\n\n\nروش وارون\nمتداول‌ترین روش برای شبیه‌سازی از متغیرهای تصادفی روش وارون است. اساس کار این روش استفاده از قضیه تبدیل انتگرالی احتمال1 و عکس آن2 می‌باشد.\nقضیه (عکس تبدیل انتگرالی احتمال): فرض کنید \\(F_{X}(.)\\) یک تابع توزیع تجمعی دلخواه (گسسته یا پیوسته) و \\(U\\) یک متغیر تصادفی با توزیع یکنواخت پیوسته روی بازه (0,1) باشد. اگر \\(F_X^{-1}(.)\\) وارون تعمیم یافته این تابع توزیع باشد که به صورت زیر تعریف می‌شود:\n\\[\\begin{align*}\n        F^{-1}(u)=\\min\\{x|F_{X}(x)\\geq u\\} = \\max\\{x|F_{X}(x)\\leq u\\}\n\\end{align*}\\]\nدر این صورت متغیر تصادفی \\(F_X^{-1}(U)\\) دارای تابع توزیع \\(F_{X}(.)\\) است، یعنی دو متغیر \\(F_X^{-1}(U)\\) و \\(X\\) هم توزیع هستند.\n\nنکته: در صورتی که تابع \\(F\\) وارون‌پذیر (اکیداً صعودی و پیوسته) باشد، \\(F^{-1}(u)\\) همان وارون معمولی (چندک) تابع \\(F\\) است.\n\nنکته:برای سادگی در نوشتار و همچنین مشابه‌ بودن نمادگذاری دو متغیر تصادفی هم توزیع، در ادامه این فصل متغیر تصادفی \\(F_X^{-1}(U)\\) را با نماد \\(X^{*}\\) نشان می‌دهیم. یعنی بر اساس قضیه قبل داریم\n\\[\nX^{*} \\overset{D}{=} X \\quad \\Rightarrow \\quad F_X^{-1}(U) \\sim F_X\n\\]\nبا استفاده از قضیه فوق و با در اختیار داشتن تابع توزیع \\(F_{X}(x)\\) می‌توان مقادیری از متغیر تصادفی \\(X^{*}\\) را شبیه‌سازی کرد و چون این متغیر با متغیر هدف \\(X\\)، هم‌توزیع می‌باشد، می‌توان این مقادیر تولید شده را به عنوان مقادیر تولید شده از متغیر هدف در نظر گرفت.\n\nالگوریتم روش تبدیل وارون: برای تولید یک عدد تصادفی به روش وارون از متغیر تصادفی \\(X\\) با تابع توزیع \\(F^{-1}_X\\) گام‌های زیر را انجام می‌دهیم:\n\nتابع \\(F_X^{-1}(.)\\) را بدست می‌آوریم.\nیک مقدار تصادفی \\(u\\) را از توزیع \\(\\mathcal{U}(0,1)\\) تولید می‌کنیم.\nمقدار \\(F_X^{-1}(u)\\) را به عنوان عدد تولیدی محاسبه می‌کنیم.\n\nمثال‌های زیر شیوه استفاده از الگوریتم بالا را نشان‌ می‌دهند.\nمثال 1:فرض کنید \\(X\\sim \\mathcal{B}in(1,p)\\). به روش وارون یک عدد تصادفی از این توزیع تولید کنید.\n\\[\\begin{align*}\n        &\\mathbb{P}(X=x)=p^{x}(1-p)^{1-x} \\quad  ; x=0,1\n        \\notag\\\\[0.5cm]\n\n&\\Rightarrow F_{X}(x)= \\begin{cases}\n            0 & \\quad ; x&lt;0 \\\\\n            1-p & \\quad ; 0\\leq x&lt;1 \\\\\n            1 & \\quad ; x\\geq 1\\\\\n        \\end{cases}\n    \\end{align*}\\]\n\n\n\n\n\n\\[\n\\begin{align*}      \n&X^{*}=\\min \\{x|F_{X}(x)\\geq u\\}=\\begin{cases}          \\min \\{[0,+\\infty)\\}=0 & \\quad ; 0&lt;u&lt;1-p \\\\         \\min\\{[1,+\\infty)\\}=1 & \\quad ; 1-p&lt;u&lt;1 \\\\      \\end{cases}\\notag\\\\\n\\Rightarrow \\quad &X^{*}= \\begin{cases}         0 & \\quad ; 0&lt;u&lt;1-p \\\\          1 & \\quad ; 1-p&lt;u&lt;1 \\\\      \\end{cases} \\end{align*}\n\\]\nبنابراین کافی است ابتدا با استفاده از تابع runif یک عدد تصادفی از توزیع یکنواخت روی بازه \\((0,1)\\) تولید کنیم و با جایگذاری در رابطه فوق مقادیر \\(x^{*}\\) را تولید کنیم.\n\np = 0.5\nu = runif(1)\nifelse(u &lt; (1-p) , 0, 1) \n\n[1] 0\n\n\nتمرین 1: با استفاده از نرم‌افزار R برنامه‌ای بنویسید که از توزیع \\(\\mathcal{B}in(1,p)\\) یا همان \\(\\mathcal{B}er(p)\\)، \\(n\\) عدد تصادفی تولید کند.\nبیان ساده قضیه قبل به صورت زیر می‌باشد.\nفرض کنید \\(X\\) یک متغیر تصادفی گسسته با تابع جرم احتمال \\(\\mathbb{P}(X=x_{i})=p_{i}\\quad i=1,2,\\ldots\\) باشد. در این صورت با فرض اینکه \\(u\\sim \\mathcal{U}(0,1)\\) و چون \\(F_{X}(x_{i})=\\mathbb{P}(X\\leq x_{i})=\\sum_{j=1}^{i}p_{j}\\) ، نتیجه می‌شود: \\[\\begin{align*}\n    &F_{X}(x)=\\begin{cases}\n        0 & \\quad ; X&lt;x_{1} \\\\\n        p_{1} & \\quad ; x_{1}\\leq X&lt;x_{2} \\\\\n        p_{1}+p_{2} & \\quad ; x_{2}\\leq X &lt;x_{3} \\\\\n        ~~~ \\vdots & \\quad  ~~~~~~\\vdots\\\\\n        1\\\\\n    \\end{cases}\\notag\\\\&\\Rightarrow\n    X^{*}=\\begin{cases}\n        x_{1} & \\quad ; u&lt;p_{1} \\\\\n        x_{2} & \\quad ; p_{1}\\leq u&lt;p_{1}+p_{2} \\\\\n        ~~\\vdots& \\quad  ~~~~~~\\vdots\\\\\n        x_{i} & \\quad ;\\sum_{j=1}^{i-1}p_{j}\\leq u&lt;\\sum_{j=1}^{i}p_{j}\\\\\n        ~~\\vdots& \\quad  ~~~~~~\\vdots\\\\\n    \\end{cases}\n\\end{align*}\\]\nطبق قضیه قبل باید نشان دهیم \\(X^{*}\\) دارای توزیع \\(F_{X}(x)\\) است. به عبارت دیگر باید نشان دهیم که \\(\\mathbb{P}(X^{*}=x_{i})=p_{i}\\).\n\\[\\begin{align*}\n    \\mathbb{P}(X^{*}=x_{i})=&\\mathbb{P}(\\sum_{j=1}^{i-1}p_{j}&lt;u&lt;\\sum_{j=1}^{i}p_{j})=\\int_{\\sum_{j=1}^{i-1}p_{j}}^{\\sum_{j=1}^{i}p_{j}}du\\notag\\\\&=\\sum_{j=1}^{i}p_{j}-\\sum_{j=1}^{i-1}p_{j}=p_{i}\n\\end{align*}\\]\nبنابراین با توجه به مطالب بیان شده، فرآیند بالا را می‌توان در قالب الگوریتم زیر خلاصه کرد.\n\nیک عدد تصادفی از توزیع یکنواخت پیوسته روی بازه \\((0,1)\\) تولید می‌کنیم\nاگر \\(u&lt;p_{1}\\) آن‌گاه \\(X^{*}=x_{1}\\) و الگوریتم متوقف می‌شود، در غیر اینصورت به گام بعد می‌رویم.\nاگر \\(u&lt;p_{1}+p_{2}\\) آن‌گاه \\(X^{*}=x_{2}\\) و الگوریتم متوقف می‌شود، در غیر اینصورت به گام بعد می‌رویم.\nاگر \\(u&lt;p_{1}+p_{2}+p_{3}\\) آن‌گاه \\(X^{*}=x_{3}\\) و الگوریتم متوقف می‌شود، در غیر اینصورت به گام بعد می‌رویم.\n…\n\nبه عبارت دیگر در هر مرحله مقدار متغیر \\(X\\) را با پیدا کردن بازه‌ی \\(\\Big(F(x_{i-1}),F(x_{i})\\Big)\\) که شامل \\(u\\) می‌شود یا به‌طور معادل پیدا کردن \\(F^{-1}(u)\\) به دست می‌آوریم.\nمثال 2:فرض کنید \\(X\\sim \\mathcal{D}u(\\{1,2,\\ldots,n\\})\\) . با استفاده از روش وارون از این توزیع داده تصادفی تولید کنید.\n\\[\\begin{align*}\n        &\\mathbb{P}(X=j)=\\dfrac{1}{n}  \\quad ;j=1,2,\\ldots,n\\\\\n        &F_{X}(x_{j})=\\mathbb{P}(X\\leq x_{j})=\\mathbb{P}(X\\leq j)=\\dfrac{j}{n}\\\\\n        &\\Rightarrow X^{*}=j \\quad \\mathrm{if} \\quad \\dfrac{j-1}{n}&lt;u&lt;\\dfrac{j}{n}\\\\\n        &\\Rightarrow j-1&lt;nu&lt;j\n    \\end{align*}\\] پس \\(X^{*}=j\\) خواهد بود اگر داشته باشیم \\(j-1&lt;nu&lt;j\\) یا به عبارتی \\([nu]=j-1\\) پس می‌توان گفت \\[\\begin{align*}\n        X^{*}=[nu]+1\n    \\end{align*}\\] به عنوان مثال اگر \\(n=5\\) باشد و \\(u=0.3\\) داده تصادفی از توزیع \\(\\mathcal{D}u(\\{1,2,\\ldots,5\\})\\) برابر است با \\[\\begin{align*}\n    X^{*}=[5\\times0.3]+1=[1.5]+1=2\n\\end{align*}\\]\n\nn = 5\nu = runif(1)\nx = floor(n*u) + 1\nx\n\n[1] 4\n\n\nتمرین 2: با استفاده از نرم‌افزار R، برنامه‌ای بنویسید که از الگوریتم فوق n داده تولید کند.\nتمرین 3: اگر \\(X\\sim \\mathcal{D}u\\Big(\\{3,4,\\ldots,N\\}\\Big)\\) باشد، با استفاده از نرم‌افزار R، برنامه‌ای بنویسید که از این توزیع n داده تولید کند.\nتمرین 4: فرض کنید \\(X\\) یک متغیر تصادفی باشد که مقادیر \\(x_{1},x_{2},\\ldots x_{n}\\) را با احتمال‌های \\(\\mathbb{P}(X=x_{i})=p_{i}\\) اختیار کند. برنامه‌ای بنویسید که بر اساس روش وارون از این توزیع عدد تصادفی تولید کند.\nمثال 3: فرض کنید \\(X\\) یک متغیر تصادفی با تابع جرم احتمال به صورت زیر باشد. الگوریتمی برای تولید داده از این چگالی با استفاده از روش وارون ارائه دهید.\n\n\n\n4\n3\n2\n1\n\\(\\{X=j\\}\\)\n\n\n0.4\n0.25\n0.15\n0.2\n\\(\\mathbb{P}(\\{X=j\\})\\)\n\n\n\n\\[\\begin{align*}\n        X^{*}&=\\begin{cases}\n            x_{1} & \\quad ; u&lt;p_{1} \\\\\n            x_{2} & \\quad ; p_{1}&lt;u&lt;p_{1}+p_{2} \\\\\n            x_{3} & \\quad ; p_{1}+p_{2}&lt;u&lt;p_{1}+p_{2}+p_{3} \\\\\n            x_{4} & \\quad ; p_{1}+p_{2}+p_{3}&lt;u&lt;1 \\\\\n        \\end{cases}\\\\[0.3cm]\n        &=\\begin{cases}\n            1 & \\quad ; u&lt;0.2 \\\\\n            2 & \\quad ; 0.2&lt;u&lt;0.35 \\\\\n            3 & \\quad ; 0.35&lt;u&lt;0.6 \\\\\n            4 & \\quad ; 0.6&lt;u&lt;1 \\\\\n        \\end{cases}\n    \\end{align*}\\]\n\nعدد تصادفی \\(u\\) را از توزیع \\(\\mathcal{U}(0,1)\\) تولید می‌کنیم\nاگر \\(u&lt;0.2\\) عدد تصادفی تولیدی \\(x^{*}=1\\) خواهد بود، در غیر این صورت به گام بعد می‌رویم.\nاگر \\(0.2&lt;u&lt;0.35\\) آن‌گاه \\(x^{*}=2\\) خواهد بود، در غیر این صورت به گام بعد می‌رویم.\nاگر \\(0.35&lt;u&lt;0.6\\) آن‌گاه \\(x^{*}=3\\) خواهد بود، در غیر اینصورت به گام بعد می‌رویم.\nاگر \\(0.6&lt;u&lt;1\\) آن‌گاه \\(x^{*}=4\\) خواهد بود\n\n\nu = runif(1)\nif(u &lt; 0.2){\n  x = 1\n}else if(u &lt; 0.35){\n  x = 2\n}else if(u &lt; 0.6){\n  x = 3\n}else{\n  x = 4\n}\nx\n\n[1] 2\n\n\nتمرین 5: با استفاده از نرم‌افزار R، برنامه‌ای بنویسید که از الگوریتم فوق n داده تولید کند.\nمثال 4: فرض کنید \\(X\\) متغیر تصادفی تعداد آزمایش مورد نیاز تا رسیدن به اولین موفقیت باشد. با استفاده از روش وارون الگوریتمی برای تولید داده از توزیع هندسی با پارامتر \\(p\\) ارائه دهید.\n\\[\\begin{align*}\n        \\mathbb{P}(X=x)=pq^{x-1}  \\quad ; x=1,2,\\ldots \\quad ; q=1-p\n    \\end{align*}\\]\nطبق روش بیان شده داریم:\n\\[\\begin{align*}\n        X^{*}=i \\quad \\mathrm{if} \\quad \\sum_{j=1}^{i-1}\\mathbb{P}\\{X=j\\}&lt;u&lt;\\sum_{j=1}^{i}\\mathbb{P}\\{X=j\\}\n    \\end{align*}\\]\nاز طرفی\n\\[\\begin{align*}\n        &\\sum_{j=1}^{i}\\mathbb{P}\\{X=j\\}=1-\\mathbb{P}\\{X&gt;i\\}=1-q^{i}\\\\\n        \\Rightarrow& X^{*}=i\\quad \\overset{\\mathrm{if}}{\\Rightarrow} \\quad 1-q^{i-1}&lt;u&lt;1-q^{i}\\quad \\Rightarrow  q^{i}&lt;1-u&lt;q^{i-1}\n\\end{align*}\\]\nحال با توجه به یکنوا بودن تابع \\(\\log\\)، داریم\n\\[\\begin{align*}\n        &\\log(q^{i})&lt;\\log(1-u)&lt;\\log(q^{i-1})\\\\  \\Rightarrow \\quad & i\\log(q)&lt;\\log(1-u)&lt;(i-1)\\log(q)\n\\end{align*}\\]\nچون \\(\\log(q)&lt;0\\) پس\n\\[\\begin{align*}\n        i-1&lt;\\dfrac{\\log(1-u)}{\\log(q)}&lt;i\n\\end{align*}\\]\nو در نهایت\n\\[\\begin{align*}\n        X^{*}=\\Big[\\dfrac{\\log(1-u)}{\\log(q)}\\Big]+1\n\\end{align*}\\]\nو چون \\(1-U\\overset{D}{=}U\\) پس می‌توان نوشت\n\\[\\begin{align*}\n        X^{*}=\\Big[\\dfrac{\\log(u)}{\\log(q)}\\Big]+1\n\\end{align*}\\]\n\np = 0.5\nu = runif(1)\nx = floor(log(u)/log(1-p))+1\nx\n\n[1] 1\n\n\nتمرین 6: با استفاده از نرم‌افزار R، برنامه‌ای بنویسید که از الگوریتم فوق n داده تولید کند.\nتمرین 7: فرض کنید \\(X\\) متغیر تصادفی هندسی (مدل تعداد شکست) باشد، الگوریتمی برای شبیه‌سازی از این توزیع بر اساس روش وارون ارائه و آن را در \\(R\\) پیاده‌سازی کنید.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>فصل دوم: شبیه‌سازی از توزیع‌های آماری</span>"
    ]
  },
  {
    "objectID": "Ch_2.html#footnotes",
    "href": "Ch_2.html#footnotes",
    "title": "فصل دوم: شبیه‌سازی از توزیع‌های آماری",
    "section": "",
    "text": "Probability Integral Transform↩︎\nInverse Probability Integral Transform↩︎",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>فصل دوم: شبیه‌سازی از توزیع‌های آماری</span>"
    ]
  }
]