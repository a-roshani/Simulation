![](cover1.png){fig-align="right" width="635"}

# فصل اول: تولید اعداد تصادفی

## مقدمه

شبیه سازی یک ابزار قدرتمند برای طراحی و تحلیل سیستم‌ها یا فرآیندهای پیچیده است که با ارائه حالت یا نمونه‌های مشابه با نمونه اصلی، به استفاده کنندگان از آن، امکان انجام آزمایش با سیستم‌هایی را می‌دهد که در عمل غیر ممکن یا پر هزینه هستند.

**مثال:**

-   آموزش خلبانی و

-   مانور زلزله

-   سینما چندبُعدی

## شبیه‌سازی در آمار

از کاربردهای شبیه‌سازی در آمار می‌توان موارد زیر را نام برد:

-   تولید اعداد تصادفی و شبه‌تصادفی

-   تولید داده‌های تصادفی از توزیع‌های گسسته یا پیوسته

-   محاسبه (تقریب) انتگرال‌ها و احتمال‌های پیچیده

-   تقریب امید ریاضی توابعی از متغیرهای تصادفی

-   تقریب توان یک آزمون

### اعداد تصادفی و شبه‌تصادفی

**اعداد تصادفی (Random Numbers):** اعدادی هستند که بر مبنای یک سری جریانات یا بر اساس یک منبع خارجی بدون هیچ رابطه خاصی تولید می‌شوند، بنابراین این اعداد قابلیت باز تولید را ندارند، یعنی اگر مجموعه‌ای از اعداد از اعداد تصادفی تولید شوند دوباره [نمی‌توان]{style="color: red"} دقیقاً همان اعداد را تولید کرد.

**اعداد شبه‌تصادفی (PseudoRandom Numbers):** اعدادی هستند که بر مبنای یک رابطه ریاضی به دست می‌آیند. بنابراین قابلیت بازتولید دارند، یعنی اگر مجموعه‌ای از اعداد از اعداد تصادفی تولید شوند دوباره [می‌توان]{style="color: red"} دقیقاً همان اعداد را تولید کرد.

### روش‌های سنتی تولید اعداد تصادفی

در گذشته برای شبیه‌سازی اعداد تصادفی در بازه (0,1) از عقربه‌ گردان استفاده می‌شد. این وسیله دارای صفحه‌ی دایره‌ مانندی شبیه ساعت است که محیط آن در فاصله صفر تا یک درجه‌بندی شده است. در مرکز این دایره یک عقربه قرار می‌گیرد که می‌تواند آن را چرخاند و در نتیجه عقربه بعد از دهها بار چرخش (که تعداد دفعات چرخش آن نیز تقریبا تصادفی است) از حرکت می‌ایستد. نوک عقربه عدد تصادفی مورد نظر را مشخص می‌کند.

![](circle.png){fig-align="center"}

### روش‌های ابداعی

-   پرتاب یک سکه

-   باز کردن صفحه‌ای از یک کتاب به صورت تصادفی

-   انتخاب از بین چند گوی

------------------------------------------------------------------------

**تمرین 1:**

الف) روشی تصادفی برای تولید عدد از بازه (0,100) پیشنهاد دهید.

ب) آیا می توان روش ابداعی شما را برای تولید داده از هر بازه‌ای مورد استفاد قرار داد؟ مثال بزنید.

ج) آیا می توان از روش ابداعی شما برای تولید داده از نوع کیفی (میزان تحصیلات یا گروه خونی) نیز استفاده کرد؟

------------------------------------------------------------------------

## روش توان دوم ارقام میانی

این روش یک روش ریاضی برای تولید اعداد تصادفی $m$ رقمی است. در این روش که به وسیله فون نیومن و متروپولیس (1946) پیشنهاد شده، مراحل زیر را انجام می‌دهیم:

1.  به دلخواه عددی $m$ رقمی را در نظر می‌گیریم

2.  این عدد را به توان دو می‌رسانیم و در صورت لزوم عدد صفر را به سمت چپ عدد بدست آمده اضافه می‌کنیم.

3.  $m$ رقم میانی عدد حاصل شده را به عنوان عدد تصادفی تولید شده در نظر می‌گیریم.

4.  برای تولید دنباله‌ای از اعداد تصادفی گام‌های 2 و 3 را تکرار می‌کنیم.

**نکته:** برای تولید اعداد تصادفی در بازه $(0,1)$ با استفاده از روش توان دوم ارقام میانی کافی است در پایان کار، دنباله اعداد $m$ رقمی بدست آمده را بر $10^m$ تقسیم کرد.

------------------------------------------------------------------------

**مثال:**

الف) با استفاده از روش توان دوم ارقام میانی یک عدد 4 رقمی تولید کنید.

ب) با استفاده از نکته فوق عددی تصادفی در بازه $(0,1)$ تولید کنید.$$
x_0 = 2152 \quad \longrightarrow\quad x_0^2 = 04631104 \quad\longrightarrow \quad x_1 = 6311
$$

برای تولید اعداد دیگر کافیست که عدد 6311 را به عنوان مقدار اولیه الگوریتم در نظر بگیریم.

------------------------------------------------------------------------

**مثال:**

مثال قبل را با استفاده از نرم افزار `R` حل کنید.

```{r}
x0 <- 2152
x1 <- x0^2
if(nchar(x1)%%2==1){t <- substr(x1,2,5)}else{t <- substr(x1,3,6)}
as.numeric(t)
```

------------------------------------------------------------------------

**تمرین 2:**

به وسیله نرم افزار `R` تابعی را بنویسید که براساس روش توان دوم ارقام میانی `n` عدد تصادفی چهار رقمی تولید کند.

------------------------------------------------------------------------

### معایب روش توان دوم ارقام میانی

-   **رخ دادن دوره تناوب**

    فرض کنید مقدار اولیه 2500 باشد، در نتیجه توان دوم این عدد 6250000 خواهد بود و در نهایت همان 2500 انتخاب خواهد شد.

-   **خروجی نامعتبر**

    فرض کنید مقدار اولیه 1000 باشد، در نتیجه توان دوم این عدد 1000000 خواهد بود و در نهایت عدد 0000 انتخاب خواهد شد.

    فرض کنید مقدار اولیه 1001 باشد، در نتیجه توان دوم این عدد 1002001 خواهد بود و در نهایت عدد 0020 انتخاب خواهد شد.

## روش‌های همنهشتی

روش‌های همنهشتی برای تولید اعداد تصادفی شامل سه روش همنهشتی ضربی، همنهشتی مرکب و همنهشتی جمعی می باشد.

### روش‌ همنهشتی ضربی

در این روش الگوریتم تولید عدد با یک مقدار اولیه (`initial value`) مانند $x_0$ شروع می‌شود که عدد تغذیه (`seed`) نامیده می‌شود. سپس مقادیر $x_n (n \geq 1)$ را از رابطه بازگشتی $x_n \overset{m}{\equiv} ax_{n-1}$ محاسبه می‌کنیم که در آن $a$ و $m$ (پیمانه `modulo`) اعداد صحیح مثبت هستند. رابطه فوق بدین معنی است که باقیمانده تقسیم $ax_{n-1}$ بر $m$ به عنوان مقدار $x_n$ می‌تواند یکی از مقادیر صحیح صفر تا $m-1$ را اختیار کند، لذا $\frac{x_n}{m}$ یک عدد شبه تصادفی در بازه $(0,1)$ است.

------------------------------------------------------------------------

**مثال:**

با انتخاب مقادیر دلخواه $x_0, a, m$ دو عدد تصادفی در بازه $(0,1)$ تولید کنید.

$$
\begin{align}
& x_0 = 51, \quad a = 13, \quad m =7\\
& x_1 \overset{7}{\equiv} 13 \times 51 = 663 \Rightarrow x_1 = 5 \Rightarrow \frac{5}{7} = 0.7142857\\
& x_2 \overset{7}{\equiv} 13 \times 5 = 65 \Rightarrow x_2 = 2 \Rightarrow \frac{2}{7} = 0.2857143
\end{align}
$$

**مثال:**

مثال بالا را با استفاده از نرم افزار `R` حل کنید.

```{r}
x0 <- 51 ; a <- 13 ; m <- 7
x1 <- (a*x0) %% m 
x2 <- (a*x1) %% m 
x1/m ; x2/m
```

------------------------------------------------------------------------

**تمرین 3:**

به وسیله نرم افزار `R` برنامه‌ای بنویسید که `n` عدد تصادفی از بازه `(0,1)` بر اساس روش همنهشتی ضربی تولید کند.

------------------------------------------------------------------------

### روش‌ همنهشتی جمعی

در این روش دنباله اعداد تصادفی از رابطه $x_n \overset{m}{\equiv} x_{n-1} + x_{n-2}$ بدست می‌آیند. در روش فوق باید دو مقدار اولیه $x_0$ و $x_1$ از قبل مشخص شوند.

$$
\begin{align}
& x_0 = 12, \quad x_1 = 3, \quad m =7\\
& x_2 \overset{7}{\equiv} 12 + 3 \Rightarrow x_2 = 1 \\
& \frac{x_2}{7} = \frac{1}{7} = 0.1428571
\end{align}
$$

------------------------------------------------------------------------

**تمرین 4:**

به وسیله نرم افزار `R` برنامه‌ای بنویسید که `n` عدد تصادفی از بازه `(0,1)` بر اساس روش همنهشتی جمعی تولید کند.

------------------------------------------------------------------------

### روش‌ همنهشتی مرکب

در روش همنهشتی مرکب که ترکیبی از حالات ضربی و جمعی است، دنباله اعداد تصادفی از رابطه همنهشتی $x_n \overset{m}{\equiv} ax_{n-1} + x_{n-2}$ بدست می‌آیند.

**نکته:**

در روش‌های همنهشتی چون هر یک از اعداد $x_n$ یکی از مقادیر صحیح صفر تا $m-1$ را اختیار می‌کند، لذا بعد از اینکه تعداد متناهی (حداکثر $m$ ) مقدار تولید شود، یک مقدار بایستی تکرار شود و به مجرد پیش آمدن این امر تکرار تمام دنباله‌ها شروع می‌شود؛ لذا باید مؤلفه‌های $a$ و $m$ را طوری انتخاب کنیم که از رخ دادن چنین امری جلوگیری شود.

------------------------------------------------------------------------

**تمرین 5:**

به وسیله نرم افزار `R` برنامه‌ای بنویسید که `n` عدد تصادفی از بازه `(0,1)` بر اساس روش همنهشتی مرکب تولید کند.
